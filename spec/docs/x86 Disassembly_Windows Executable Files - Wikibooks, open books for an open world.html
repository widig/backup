<!DOCTYPE html>
<!-- saved from url=(0070)https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files -->
<html class="client-js ve-not-available" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>x86 Disassembly/Windows Executable Files - Wikibooks, open books for an open world</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"X86_Disassembly/Windows_Executable_Files","wgTitle":"X86 Disassembly/Windows Executable Files","wgCurRevisionId":3088866,"wgRevisionId":3088866,"wgArticleId":40410,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["X86 Disassembly"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"X86_Disassembly/Windows_Executable_Files","wgRelevantArticleId":40410,"wgRequestId":"V-9l1ApAAD8AAdQRsVwAAADD","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":true,"dialogs":true,"preview":false,"publish":false},"wgBetaFeaturesFeatures":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","usePageImages":false,"usePageDescriptions":true},"wgPreferredVariant":"en","wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgULSCurrentAutonym":"English","wgNoticeProject":"wikibooks","wgCentralNoticeCookiesToDelete":[],"wgCentralNoticeCategoriesUsingLegacy":["Fundraising","fundraising"],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}","wgFlaggedRevsParams":{"tags":{"value":{"levels":3,"quality":2,"pristine":3}}},"wgStableRevisionId":3077082,"wgCentralAuthMobileDomain":false,"wgVisualEditorToolbarScrollOffset":0,"wgEditSubmitButtonLabelPublish":false});mw.loader.state({"ext.globalCssJs.user.styles":"ready","ext.globalCssJs.site.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.pygments":"ready","wikibase.client.init":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.flaggedRevs.basic":"ready","ext.wikimediaBadges":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready","ext.globalCssJs.user":"ready","ext.globalCssJs.site":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1dqfd7l",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","ext.centralauth.centralautologin","mmv.head","ext.visualEditor.desktopArticleTarget.init","ext.uls.interface","skins.vector.js"]);});</script>
<link rel="stylesheet" href="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/load.php">
<script async="" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/load(1).php"></script>
<style>
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:#fff;cursor:pointer;border:solid 1px #aaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:#fff;cursor:pointer;border:solid 1px #aaa;padding:0;margin:0}.suggestions-result{color:#000;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4c59a6;color:#fff}.suggestions-special .special-label{color:#808080;text-align:left}.suggestions-special .special-query{color:#000;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:#c0c0c0}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:#fff}.highlight{font-weight:bold}
@media print{#centralNotice{display:none}}.cn-closeButton{display:inline-block;zoom:1;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAACeklEQVR4Aa1UM3jkcRBN6qS//tTFttPHqmI359VZ5dm2L1zFtr02YlRx5sX2ft/7ed7O/w1M5ufnt8NZQjCBQXhG+IYZe5zjfju7xcHc3NzEzMwM6xOEqNnZ2ZeVlZW827dv1ycmJnbGx8d3Yr5582Z9eXk5D/d4h/empqYm+K0nw3yKcF4sFmdzOJzGgIAAhb29vc7Ozk6/Atrr/fz8lCwWq6m3tzcb72G3nmzFo/NNTU354eHhIltbW72Tk5M2IyND9P79+8ZPnz7VvXnzpoHBYPS4uLhobGxsDMHBwaLa2tp82MF+PVmUUqnMioiI6LOysjLQLCcPS2ZmZn7Ozc39oPtFYG80GgWpqakSS0tLY1hYmEgikWTBfoXsLD16BT3gUWhoqEKtVheREZ+Qu0IEjI+PZ2k0GqFer+cnJSWJra2tDWw2u2FqauoVeEAW3NzcnBcYGCh3dHTUtba2ltNjLvRJSEiQEQEPRENDQzkMBqPXwsKiXyqVFsFDNzc3LWmoqKmp4YIHZIyHDx9WOzg46GJiYmTk5e/h4eHstLQ0CX2ykXST4JPJ8y7sSVM5/QGMf9y4caMHf3r//v1a8IDsGRm04/D58+dtpNFPPNRqtflXrlzpI8G15IEGc2xsrFSlUglwD+Tk5NRBmuTk5A7wgOxbXFxcF8iysrIa1mskEolKvL29Ne7u7mpXV1dNaWlp9fr7X79+VYMMeQieY/dsv5p1r2g2Nja2vWZ7RXNiYuIA0dwlzwYGBjbkGXmURXeLeUa1ul2ebV8BEH+7CiAiASTYvgJ2qc3MzMzF2vz8+XPd27dvG5hMZg+CsV1tHmfXOP5+dqyddgHOI7v1srTdcwAAAABJRU5ErkJggg==);background:url(/w/extensions/CentralNotice/resources/subscribing/CloseWindow19x19.png?7596b)!ie;width:19px;height:19px;text-indent:19px;white-space:nowrap;overflow:hidden}
.uls-menu{border-radius:4px; font-size:medium}.uls-search,.uls-language-settings-close-block{border-top-right-radius:4px;border-top-left-radius:4px}.uls-language-list{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.uls-menu.callout .caret-before,.uls-menu.callout .caret-after{border-top:10px solid transparent;border-right:10px solid #c9c9c9;border-bottom:10px solid transparent;display:inline-block;left:-11px; top:17px;position:absolute}.uls-menu.callout .caret-after{border-right:10px solid #fcfcfc;display:inline-block;left:-10px}.uls-menu.callout--languageselection .caret-after{border-right:10px solid #fff}.uls-ui-languages button{margin:5px 15px 5px 0;white-space:nowrap;overflow:hidden}.uls-search-wrapper-wrapper{position:relative;padding-left:40px;margin-top:5px;margin-bottom:5px}.uls-icon-back{background:transparent url(/w/extensions/UniversalLanguageSelector/resources/images/back-grey-ltr.png?90e9b) no-repeat scroll center center;background-image:-webkit-linear-gradient( transparent,transparent ),url(/w/extensions/UniversalLanguageSelector/resources/images/back-grey-ltr.svg?ae714);background-image:linear-gradient( transparent,transparent ),url(data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20id%3D%22Layer_1%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M7%2013.1l8.9%208.9c.8-.8.8-2%200-2.8l-6.1-6.1%206-6.1c.8-.8.8-2%200-2.8L7%2013.1z%22%20id%3D%22path3%22%20fill%3D%22%23555%22%2F%3E%0A%3C%2Fsvg%3E%0A);background-image:linear-gradient( transparent,transparent ),url(/w/extensions/UniversalLanguageSelector/resources/images/back-grey-ltr.svg?ae714)!ie;background-size:28px;background-position:center center;height:32px;width:40px;display:block;position:absolute;left:0;border-right:1px solid #c9c9c9;opacity:0.8}.uls-icon-back:hover{opacity:1;cursor:pointer}</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:#000;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:#fff}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
@media screen {
	.tochidden,.toctoggle{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.toctoggle{font-size:94%}}
@media print {
	#toc.tochidden,.toctoggle{display:none}}
.mw-ui-button{font-family:inherit;font-size:1em;display:inline-block;min-width:4em;max-width:28.75em;padding:.5em 1em;margin:0;border-radius:2px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;*display:inline;zoom:1;vertical-align:middle;background-color:#f8f9fa;color:#222222;border:1px solid #9aa0a7;text-align:center;font-weight:bold;cursor:pointer}.mw-ui-button:visited{color:#222222}.mw-ui-button:hover{background-color:#ffffff;color:#444444;border-color:#a2a9b1}.mw-ui-button:focus{background-color:#ffffff;color:#222222;border-color:#3366cc;box-shadow:inset 0 0 0 1px #3366cc,inset 0 0 0 2px #ffffff}.mw-ui-button:active,.mw-ui-button.is-on,.mw-ui-button.mw-ui-checked{background-color:#d9d9d9;color:#000000;border-color:#72777d;box-shadow:none}.mw-ui-button:disabled{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1}.mw-ui-button:disabled:hover,.mw-ui-button:disabled:active{background-color:#c8ccd1;color:#fff;box-shadow:none;border-color:#c8ccd1}.mw-ui-button:focus{outline-width:0}.mw-ui-button:focus::-moz-focus-inner{border-color:transparent;padding:0}.mw-ui-button:not( :disabled ){-webkit-transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms;-moz-transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms;transition:background-color 100ms,color 100ms,border-color 100ms,box-shadow 100ms}.mw-ui-button:disabled{text-shadow:none;cursor:default}.mw-ui-button.mw-ui-big{font-size:1.3em}.mw-ui-button.mw-ui-block{display:block;width:100%;margin-left:auto;margin-right:auto}.mw-ui-button.mw-ui-progressive,.mw-ui-button.mw-ui-constructive,.mw-ui-button.mw-ui-primary{background-color:#3366cc;color:#fff;border:1px solid #3366cc;text-shadow:0 1px rgba(0,0,0,0.1)}.mw-ui-button.mw-ui-progressive:hover,.mw-ui-button.mw-ui-constructive:hover,.mw-ui-button.mw-ui-primary:hover{background-color:#447ff5;border-color:#447ff5}.mw-ui-button.mw-ui-progressive:focus,.mw-ui-button.mw-ui-constructive:focus,.mw-ui-button.mw-ui-primary:focus{box-shadow:inset 0 0 0 1px #3366cc,inset 0 0 0 2px #ffffff}.mw-ui-button.mw-ui-progressive:active,.mw-ui-button.mw-ui-constructive:active,.mw-ui-button.mw-ui-primary:active,.mw-ui-button.mw-ui-progressive.is-on,.mw-ui-button.mw-ui-constructive.is-on,.mw-ui-button.mw-ui-primary.is-on,.mw-ui-button.mw-ui-progressive.mw-ui-checked,.mw-ui-button.mw-ui-constructive.mw-ui-checked,.mw-ui-button.mw-ui-primary.mw-ui-checked{background-color:#2a4b8d;border-color:#2a4b8d;box-shadow:none}.mw-ui-button.mw-ui-progressive:disabled,.mw-ui-button.mw-ui-constructive:disabled,.mw-ui-button.mw-ui-primary:disabled{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1}.mw-ui-button.mw-ui-progressive:disabled:hover,.mw-ui-button.mw-ui-constructive:disabled:hover,.mw-ui-button.mw-ui-primary:disabled:hover,.mw-ui-button.mw-ui-progressive:disabled:active,.mw-ui-button.mw-ui-constructive:disabled:active,.mw-ui-button.mw-ui-primary:disabled:active,.mw-ui-button.mw-ui-progressive:disabled.mw-ui-checked,.mw-ui-button.mw-ui-constructive:disabled.mw-ui-checked,.mw-ui-button.mw-ui-primary:disabled.mw-ui-checked{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1;box-shadow:none}.mw-ui-button.mw-ui-progressive.mw-ui-quiet,.mw-ui-button.mw-ui-constructive.mw-ui-quiet,.mw-ui-button.mw-ui-primary.mw-ui-quiet{color:#222222}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:hover,.mw-ui-button.mw-ui-constructive.mw-ui-quiet:hover,.mw-ui-button.mw-ui-primary.mw-ui-quiet:hover{background-color:transparent;color:#447ff5}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:active,.mw-ui-button.mw-ui-constructive.mw-ui-quiet:active,.mw-ui-button.mw-ui-primary.mw-ui-quiet:active,.mw-ui-button.mw-ui-progressive.mw-ui-quiet.mw-ui-checked,.mw-ui-button.mw-ui-constructive.mw-ui-quiet.mw-ui-checked,.mw-ui-button.mw-ui-primary.mw-ui-quiet.mw-ui-checked{color:#2a4b8d}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:focus,.mw-ui-button.mw-ui-constructive.mw-ui-quiet:focus,.mw-ui-button.mw-ui-primary.mw-ui-quiet:focus{background-color:transparent;color:#3366cc}.mw-ui-button.mw-ui-progressive.mw-ui-quiet:disabled,.mw-ui-button.mw-ui-constructive.mw-ui-quiet:disabled,.mw-ui-button.mw-ui-primary.mw-ui-quiet:disabled{color:#c8ccd1}.mw-ui-button.mw-ui-destructive{background-color:#cc3333;color:#fff;border:1px solid #cc3333;text-shadow:0 1px rgba(0,0,0,0.1)}.mw-ui-button.mw-ui-destructive:hover{background-color:#e53939;border-color:#e53939}.mw-ui-button.mw-ui-destructive:focus{box-shadow:inset 0 0 0 1px #cc3333,inset 0 0 0 2px #ffffff}.mw-ui-button.mw-ui-destructive:active,.mw-ui-button.mw-ui-destructive.is-on,.mw-ui-button.mw-ui-destructive.mw-ui-checked{background-color:#873636;border-color:#873636;box-shadow:none}.mw-ui-button.mw-ui-destructive:disabled{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1}.mw-ui-button.mw-ui-destructive:disabled:hover,.mw-ui-button.mw-ui-destructive:disabled:active,.mw-ui-button.mw-ui-destructive:disabled.mw-ui-checked{background-color:#c8ccd1;color:#fff;border-color:#c8ccd1;box-shadow:none}.mw-ui-button.mw-ui-destructive.mw-ui-quiet{color:#222222}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:hover{background-color:transparent;color:#e53939}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:active,.mw-ui-button.mw-ui-destructive.mw-ui-quiet.mw-ui-checked{color:#873636}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:focus{background-color:transparent;color:#cc3333}.mw-ui-button.mw-ui-destructive.mw-ui-quiet:disabled{color:#c8ccd1}.mw-ui-button.mw-ui-quiet{background:transparent;border:0;text-shadow:none;color:#222222}.mw-ui-button.mw-ui-quiet:hover{background-color:transparent;color:#444444}.mw-ui-button.mw-ui-quiet:active,.mw-ui-button.mw-ui-quiet.mw-ui-checked{color:#000000}.mw-ui-button.mw-ui-quiet:focus{background-color:transparent;color:#222222}.mw-ui-button.mw-ui-quiet:disabled{color:#c8ccd1}.mw-ui-button.mw-ui-quiet:hover,.mw-ui-button.mw-ui-quiet:focus{box-shadow:none}.mw-ui-button.mw-ui-quiet:active,.mw-ui-button.mw-ui-quiet:disabled{background:transparent}a.mw-ui-button{text-decoration:none;line-height:normal}a.mw-ui-button:hover,a.mw-ui-button:focus{text-decoration:none}.mw-ui-button-group > *{min-width:48px;border-radius:0;float:left}.mw-ui-button-group > *:first-child{border-top-left-radius:2px;border-bottom-left-radius:2px}.mw-ui-button-group > *:not( :first-child ){border-left:0}.mw-ui-button-group > *:last-child{border-top-right-radius:2px;border-bottom-right-radius:2px}.mw-ui-button-group .is-on .button{cursor:default}
.mw-ui-icon{position:relative;line-height:1.5em;min-height:1.5em;min-width:1.5em}.mw-ui-icon.mw-ui-icon-element{text-indent:-999px;overflow:hidden;width:3.5em;min-width:3.5em;max-width:3.5em}.mw-ui-icon.mw-ui-icon-element:before{left:0;right:0;position:absolute;margin:0 1em}.mw-ui-icon.mw-ui-icon-before:before,.mw-ui-icon.mw-ui-icon-element:before{background-position:50% 50%;background-repeat:no-repeat;background-size:100% auto;float:left;display:block;min-height:1.5em;content:''}.mw-ui-icon.mw-ui-icon-before:before{position:relative;width:1.5em;margin-right:1em}.mw-ui-icon.mw-ui-icon-small:before{background-size:66.67% auto}</style><style>
#p-lang .body ul .uls-trigger,#p-lang .pBody ul .uls-trigger{background-image:none;padding:0} .mw-interlanguage-selector,.mw-interlanguage-selector:active{cursor:pointer;padding:4px 6px 4px 25px;font-size:13px;font-weight:normal;background-image:url(/w/extensions/UniversalLanguageSelector/resources/images/compact-links-trigger.png?b0c8e);background-image:linear-gradient(transparent,transparent),url(data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13%2019l.8-3h5.3l.9%203h2.2l-4.2-13h-3l-4.2%2013h2.2zm3.5-11l2%206h-4l2-6z%22%20fill%3D%22%23707070%22%2F%3E%3Cpath%20d%3D%22M5%204l.938%201.906h-4.938v2.094h1.594c.6%201.8%201.406%203.206%202.406%204.406-1.1.7-4.313%201.781-4.313%201.781l1.313%201.813s3.487-1.387%204.688-2.188c1%20.7%202.319%201.188%203.719%201.688l.594-2c-1-.3-1.988-.688-2.688-1.188%201.1-1.1%201.9-2.506%202.5-4.406h2.188l.5-2h-5.563l-.938-1.906h-2zm-.188%204h3.781c-.4%201.3-.906%202-1.906%203-1.1-1-1.475-1.7-1.875-3z%22%20fill%3D%22%23707070%22%2F%3E%3C%2Fsvg%3E%0A);background-image:linear-gradient(transparent,transparent),url(/w/extensions/UniversalLanguageSelector/resources/images/compact-links-trigger.svg?45ff2)!ie;background-image:-o-linear-gradient(transparent,transparent),url(/w/extensions/UniversalLanguageSelector/resources/images/compact-links-trigger.png?b0c8e);background-size:18px;background-repeat:no-repeat;background-position:left 4px center;margin:4px 0;text-align:left}.mw-interlanguage-selector:active,.mw-interlanguage-selector.selector-open{color:#555;background-color:#ccc}.interlanguage-uls-menu:before{background:none repeat scroll 0 0 #fcfcfc;border-left:1px solid rgba(0,0,0,0.2);border-top:1px solid rgba(0,0,0,0.2);box-shadow:-2px -2px 2px rgba(0,0,0,0.1);content:'';height:16px;width:16px;left:-9px;position:absolute; top:240px;transform:rotate(-45deg);-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-o-transform:rotate(-45deg);-ms-transform:rotate(-45deg);background-clip:padding-box}body.rtl .interlanguage-uls-menu:before{transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);-ms-transform:rotate(45deg)}
.mw-mmv-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;background-color:#000000}body.mw-mmv-lightbox-open{overflow-y:auto;  }body.mw-mmv-lightbox-open #mw-page-base,body.mw-mmv-lightbox-open #mw-head-base,body.mw-mmv-lightbox-open #mw-navigation,body.mw-mmv-lightbox-open #content,body.mw-mmv-lightbox-open #footer,body.mw-mmv-lightbox-open #globalWrapper{ display:none}body.mw-mmv-lightbox-open > *{ display:none}body.mw-mmv-lightbox-open > .mw-mmv-overlay,body.mw-mmv-lightbox-open > .mw-mmv-wrapper{display:block}.mw-mmv-filepage-buttons{margin-top:5px}.mw-mmv-filepage-buttons .mw-mmv-view-expanded,.mw-mmv-filepage-buttons .mw-mmv-view-config{display:block;line-height:inherit}.mw-mmv-filepage-buttons .mw-mmv-view-expanded.mw-ui-icon:before{background-image:url(data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201024%20768%22%3E%0A%20%20%20%20%3Cg%20fill%3D%22%23777%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M851.2%2071.6L690.7%20232.1l-40.1-40.3-9.6%20164.8%20164.8-9.3-40.3-40.4L926%20146.4l58.5%2058.5L997.6%200%20792.7%2013.1%22%2F%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M769.6%2089.3H611.9l70.9%2070.8%207.9%207.5m-47.1%20234.6l-51.2%203%203-51.2%209.4-164.4%205.8-100.3H26.4V768h883.1V387l-100.9%205.8-165%209.4zM813.9%20678H113.6l207.2-270.2%2031.5-12.9L548%20599.8l105.9-63.2%20159.8%20140.8.2.6zm95.6-291.9V228l-79.1%2078.9%207.8%207.9%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A);background-image:url(/w/extensions/MultimediaViewer/resources/mmv/img/expand.svg?b714e)!ie}.mw-mmv-filepage-buttons .mw-mmv-view-config.mw-ui-icon:before{background-image:url(data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201024%20768%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M897%20454.6V313.4L810.4%20299c-6.4-23.3-16-45.7-27.3-65.8l50.5-71.4-99.4-100.2-71.4%2050.5c-20.9-11.2-42.5-20.9-65.8-27.3L582.6-1H441.4L427%2085.6c-23.3%206.4-45.7%2016-65.8%2027.3l-71.4-50.5-100.3%2099.5%2050.5%2071.4c-11.2%2020.9-20.9%2042.5-27.3%2066.6L127%20313.4v141.2l85.8%2014.4c6.4%2023.3%2016%2045.7%2027.3%2066.6L189.6%20607l99.5%2099.5%2071.4-50.5c20.9%2011.2%2042.5%2020.9%2066.6%2027.3l14.4%2085.8h141.2l14.4-86.6c23.3-6.4%2045.7-16%2065.8-27.3l71.4%2050.5%2099.5-99.5-50.5-71.4c11.2-20.9%2020.9-42.5%2027.3-66.6l86.4-13.6zm-385%2077c-81.8%200-147.6-66.6-147.6-147.6%200-81.8%2066.6-147.6%20147.6-147.6S659.6%20302.2%20659.6%20384%20593.8%20531.6%20512%20531.6z%22%20fill%3D%22%23777%22%2F%3E%0A%3C%2Fsvg%3E%0A);background-image:url(/w/extensions/MultimediaViewer/resources/mmv/img/gear_gray.svg?330ae)!ie;opacity:0.75}.mw-mmv-filepage-buttons .mw-mmv-view-config.mw-ui-icon:before:hover{opacity:1}</style><style>
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba( 255,255,255,0.5 );border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB9ElEQVR4AZWRA3AYURQArxrVHtW2bdu2bdu2zdi2bdu2bWxs7zeehZaw4f70kbs+zI3e/nWK+RWx3aOFlrL56Sy5SxrruG69hlv6OyK+mz+8KDSXdXembj0ispT7tjs4ZTIbpYBvxGSGKzZTeFrb7W/meN002swFs0U8ttpHTkF2BvCqWQrW35929bTsKm5Zb+SEwWwcY8wAngB9m7Z+d+rIPZ/npdy12M5p47n8dXsCYAf0qPy06eGMdktuDu9Qf+JmKl3SWM91qzVcN9tAbEYkwMaq0tyb1m/To5kP170el/BK8/qa6sJr70ydf+T/Uu5ab+Oo/lS0AkUBpIFWlZ9WPhxpse/PHO7YbOOczjL0vZV2lNxPPtG73dYXM+xvm2znrOl83tidoqCwMBgYXsPFB0on5S6pr+eK5TKuW67lgvaKvF8mL1dtfTL32FHxRdyx3cQpg7m4x9sCXKkTIzA4LDH44zWdzaUf71hv5rTG4uyzcusybxSX7aThbMQ8XgCYAp3rzTTQOiIh9PNlzY3FSuZxrzjme1Y7uGS6kjsWO4jPjM4FVjRZsvD4kO9XtTZzQn82NyzWc0B7AmZh6gA/hOYSGhfw9YbOVnarj+S7800AL2BIsxUAbWNToj7bhBuQmZcOsFdoKUC74rGheCwXmqAIQTc9jQcrADIAAAAASUVORK5CYII=);background-image:url(/w/resources/src/mediawiki.action/images/green-checkmark.png?d94f1)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:#000;text-shadow:0 0.0625em 0 #fff;text-decoration:none;opacity:0.2;filter:alpha( opacity=20 )}.postedit-close:hover{color:#000;text-decoration:none;opacity:0.4;filter:alpha( opacity=40 )}
@-webkit-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-webkit-transform:translateY(-20px)}100%{opacity:1;-webkit-transform:translateY(0)}}@-moz-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-moz-transform:translateY(-20px)}100%{opacity:1;-moz-transform:translateY(0)}}@-o-keyframes centralAuthPPersonalAnimation{0%{opacity:0;-o-transform:translateY(-20px)}100%{opacity:1;-o-transform:translateY(0)}}@keyframes centralAuthPPersonalAnimation{0%{opacity:0;transform:translateY(-20px)}100%{opacity:1;transform:translateY(0)}}.centralAuthPPersonalAnimation{-webkit-animation-duration:1s;-moz-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;-moz-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:centralAuthPPersonalAnimation;-moz-animation-name:centralAuthPPersonalAnimation;-o-animation-name:centralAuthPPersonalAnimation;animation-name:centralAuthPPersonalAnimation}</style><style>
.ve-activated #toc,.ve-activated #siteNotice,.ve-activated .mw-indicators,.ve-activated #t-print,.ve-activated #t-permalink,.ve-activated #p-coll-print_export,.ve-activated #t-cite,.ve-deactivating .ve-ui-surface,.ve-active .ve-init-mw-desktopArticleTarget-editableContent{display:none} .ve-activating .ve-ui-surface{height:0;padding:0 !important; overflow:hidden} .ve-loading #content > :not( .ve-init-mw-desktopArticleTarget-loading-overlay ), .ve-activated .ve-init-mw-desktopArticleTarget-uneditableContent{  pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none; opacity:0.5}.ve-activated .catlinks{cursor:pointer}.ve-activated .catlinks a{opacity:1} .ve-activated #content{position:relative} .ve-init-mw-desktopArticleTarget-loading-overlay{position:absolute;left:0;right:0;z-index:1;margin-top:-0.5em}.ve-init-mw-desktopArticleTarget-progress{height:1em;overflow:hidden;margin:0 25%}.ve-init-mw-desktopArticleTarget-progress-bar{height:1em;width:0} .mw-editsection{white-space:nowrap; unicode-bidi:-moz-isolate;unicode-bidi:-webkit-isolate;unicode-bidi:isolate}.mw-editsection-divider{color:#555} .ve-init-mw-desktopArticleTarget-progress{height:0.75em;border:1px solid #36c;background:#fff;border-radius:2px;box-shadow:0 0.1em 0 0 rgba( 0,0,0,0.15 )}.ve-init-mw-desktopArticleTarget-progress-bar{height:0.75em;background:#36c}</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/load(2).php">
<meta name="generator" content="MediaWiki 1.28.0-wmf.22">
<meta name="referrer" content="origin-when-cross-origin">
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit">
<link rel="edit" title="Edit" href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit">
<link rel="shortcut icon" href="https://en.wikibooks.org/static/favicon/wikibooks.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://en.wikibooks.org/w/opensearch_desc.php" title="Wikibooks (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://en.wikibooks.org/w/api.php?action=rsd">
<link rel="copyright" href="https://creativecommons.org/licenses/by-sa/3.0/">
<link rel="alternate" type="application/atom+xml" title="Wikibooks Atom feed" href="https://en.wikibooks.org/w/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="canonical" href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files">
<link rel="dns-prefetch" href="https://login.wikimedia.org/">
<link rel="dns-prefetch" href="https://meta.wikimedia.org/">
<script src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/load(3).php"></script><link rel="stylesheet" href="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/index.php"><link rel="stylesheet" href="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/index(1).php"></head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-X86_Disassembly_Windows_Executable_Files rootpage-X86_Disassembly skin-vector action-view feature-footer-v2">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

							<div id="siteNotice"><div id="centralNotice" class="cn-wmf_cc_4_a"><style type="text/css">

#centralNotice.collapsed #wmf_tou_cc_4_a {
 display: none;
}

#wmf_tou_cc_4_a {
 overflow: hidden;
 background: #eee;
 border: 5px solid #87CEEB;
 margin: 0.5em auto 1em auto;
 padding: 5px;
 position: relative;
}

#wmf_tou_cc_4_a a.cn-full-banner-click {
 height: 100%;
 width: 100%;
 cursor: pointer;
 display: table;
}

#wmf_tou_cc_4_a a.cn-full-banner-click {
 text-decoration: none;
}

.wmf_tou_cc_4_a-img {
 width: 70px;
}

.wmf_tou_cc_4_a-img-right {
 width: 45px;
}

#wmf_tou_cc_4_a-logo {
 position: absolute;
 top: 50%;
 left: 15px;
 width: 7%;
 height: 50px;
 margin: -25px 0 0 0;
}

#wmf_tou_cc_4_a-logo-right {
 position: absolute;
 top: 50%;
 right: 15px;
 width: 7%;
 height: 50px;
 margin: -25px 0 0 0;
}

#wmf_tou_cc_4_a #main-text {
 font-size: 1.2em;
 width: 70%;
 padding: 10px 0;
 line-height: 1.2em;
 display: table-cell;
 vertical-align: middle;
 text-align: center;
}

#wmf_tou_cc_4_a #main-text p {
 margin: 0;
}

#wmf_tou_cc_4_a #main-text p:first-child {
 margin-bottom: 0.5em;
}

#wmf_tou_cc_4_a #main-text:hover {
 text-decoration: underline;
}

#wmf_tou_cc_4_a div#cn-toggle-box {
 position: absolute;
 z-index: 1;
 top: 2px;
 right: 6px;
}

#wmf_tou_cc_4_a div#cn-translation-link {
 position:absolute;
 z-index: 1;
 bottom: 2px;
 right: 6px;
 font-size: 0.7em;
}

#cn-translation-link a, 
#cn-translation-link a:link, 
#cn-translation-link a:visited, 
#cn-translation-link a:hover, { 
 color: #0050BD; 
}

@media screen and (max-width: 950px) {

#wmf_tou_cc_4_a #main-text {
 width: 100%;
}

#wmf_tou_cc_4_a-logo, #wmf_tou_cc_4_a-logo-right {
 display: none;
}

}

@media screen and (max-width: 600px) {

#wmf_tou_cc_4_a #main-text {
 padding: 0.8em 0;
 font-size: 1.2em;
}

}

</style>

<div id="wmf_tou_cc_4_a">
  <a class="cn-full-banner-click" href="https://meta.wikimedia.org/wiki/Special:MyLanguage/Terms_of_use/Creative_Commons_4.0">
    <div id="wmf_tou_cc_4_a-logo">
      <img src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/70px-Wmf_logo_vert_K.svg.png" alt="Logo" class="wmf_tou_cc_4_a-img" width="100%">
    </div>

    <div id="main-text">
      <p>Should Wikimedia content be licensed under the latest Creative Commons license?</p>
      <p>Participate in the discussion between October 5 and November 8!</p>
    </div>

    <div id="wmf_tou_cc_4_a-logo-right">
      <img src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/70px-Cc.logo.circle.svg.png" alt="CC Logo" class="wmf_tou_cc_4_a-img-right" width="100%">
    </div>

    </a><div id="cn-toggle-box"><a class="cn-full-banner-click" href="https://meta.wikimedia.org/wiki/Special:MyLanguage/Terms_of_use/Creative_Commons_4.0">
      </a><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#" title="Close" onclick="mw.centralNotice.hideBanner();return false;"><img border="0" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/Close_x_-_black.png" alt="⧼centralnotice-shared-close⧽"></a>
    </div>
  
</div></div><!-- CentralNotice --></div>
						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">x86 Disassembly/Windows Executable Files</h1>
									<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Wikibooks, open books for an open world</div>
								<div id="contentSub"><span class="subpages">&lt; <a href="https://en.wikibooks.org/wiki/X86_Disassembly" title="X86 Disassembly">X86 Disassembly</a></span><div id="mw-fr-revisiontag" class="flaggedrevs_basic flaggedrevs_draft_notsynced plainlinks noprint nomobile"><img class="flaggedrevs-icon" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/1.png" alt="Unreviewed changes are displayed on this page" title="Unreviewed changes are displayed on this page">The <a class="external text" href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;stable=1">latest reviewed version</a> was <a class="external text" href="https://en.wikibooks.org/w/index.php?title=Special:Log&amp;type=review&amp;page=X86_Disassembly/Windows_Executable_Files">checked</a> on <i>9 May 2016</i>. There are <a class="external text" href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;oldid=3077082&amp;diff=cur&amp;diffonly=0">2 pending changes</a> awaiting review.</div>
</div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#mw-head">navigation</a>, 					<a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><center>
<div class="PrettyTextBox noprint" style="width: 90%; clear: all; padding: 5px; margin: 5px auto;"><big><b><a href="https://en.wikibooks.org/wiki/X86_Disassembly" title="X86 Disassembly">x86 Disassembly</a></b></big></div>
</center>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
<span class="toctoggle">&nbsp;[<a role="button" tabindex="0" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#MS-DOS_COM_Files"><span class="tocnumber">1</span> <span class="toctext">MS-DOS COM Files</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#MS-DOS_EXE_Files"><span class="tocnumber">2</span> <span class="toctext">MS-DOS EXE Files</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#PE_Files"><span class="tocnumber">3</span> <span class="toctext">PE Files</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Relative_Virtual_Addressing_.28RVA.29"><span class="tocnumber">4</span> <span class="toctext">Relative Virtual Addressing (RVA)</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#File_Format"><span class="tocnumber">5</span> <span class="toctext">File Format</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#MS-DOS_header"><span class="tocnumber">5.1</span> <span class="toctext">MS-DOS header</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#PE_Header"><span class="tocnumber">5.2</span> <span class="toctext">PE Header</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#COFF_Header"><span class="tocnumber">5.3</span> <span class="toctext">COFF Header</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#PE_Optional_Header"><span class="tocnumber">5.4</span> <span class="toctext">PE Optional Header</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Code_Sections"><span class="tocnumber">6</span> <span class="toctext">Code Sections</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Section_Flags"><span class="tocnumber">6.1</span> <span class="toctext">Section Flags</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Imports_and_Exports_-_Linking_to_other_modules"><span class="tocnumber">7</span> <span class="toctext">Imports and Exports - Linking to other modules</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#What_is_linking.3F"><span class="tocnumber">7.1</span> <span class="toctext">What is linking?</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Loading"><span class="tocnumber">7.2</span> <span class="toctext">Loading</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Exports"><span class="tocnumber">8</span> <span class="toctext">Exports</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Names_and_Ordinals"><span class="tocnumber">8.1</span> <span class="toctext">Names and Ordinals</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Forwarding"><span class="tocnumber">8.2</span> <span class="toctext">Forwarding</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Imports"><span class="tocnumber">9</span> <span class="toctext">Imports</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#The_Import_directory"><span class="tocnumber">9.1</span> <span class="toctext">The Import directory</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Imports_at_runtime"><span class="tocnumber">9.2</span> <span class="toctext">Imports at runtime</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Bound_imports"><span class="tocnumber">9.3</span> <span class="toctext">Bound imports</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Forwarding_and_binding"><span class="tocnumber">9.3.1</span> <span class="toctext">Forwarding and binding</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-23"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Resources"><span class="tocnumber">10</span> <span class="toctext">Resources</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Resource_structures"><span class="tocnumber">10.1</span> <span class="toctext">Resource structures</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Layout"><span class="tocnumber">10.2</span> <span class="toctext">Layout</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Relocations"><span class="tocnumber">11</span> <span class="toctext">Relocations</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Alternate_Bound_Import_Structure"><span class="tocnumber">12</span> <span class="toctext">Alternate Bound Import Structure</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Windows_DLL_Files"><span class="tocnumber">13</span> <span class="toctext">Windows DLL Files</span></a>
<ul>
<li class="toclevel-2 tocsection-29"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Function_Exports"><span class="tocnumber">13.1</span> <span class="toctext">Function Exports</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Identifying_DLL_Exports"><span class="tocnumber">13.2</span> <span class="toctext">Identifying DLL Exports</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Function_Imports"><span class="tocnumber">13.3</span> <span class="toctext">Function Imports</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#Identifying_DLL_Imports"><span class="tocnumber">13.4</span> <span class="toctext">Identifying DLL Imports</span></a></li>
</ul>
</li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="MS-DOS_COM_Files">MS-DOS COM Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=1" title="Edit section: MS-DOS COM Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>COM files are loaded into RAM exactly as they appear; no change is made at all from the harddisk image to RAM. This is possible due to the segmented memory model of the early x86 line. Two 16-bit registers determine the actual address used for a memory access, a “segment” register specifying a 64K byte window into the 1M+64K byte space (in 16-byte increments) and an “offset” specifying an offset into that window. The segment register would be set by DOS and the COM file would be expected to respect this setting and not ever change the segment registers. The offset registers, however, were fair game and served (for COM files) the same purpose as a modern 32-bit register. The downside was that the offset registers were only 16-bit and, therefore, since COM files could not change the segment registers, COM files were limited to using 64K of RAM. The good thing about this approach, however, was that no extra work was needed by DOS to load and run a COM file: just load the file, set the segment register, and jump to it. (The programs could perform 'near' jumps by just giving an offset to jump to.)</p>
<p>COM files are loaded into RAM at offset $100. The space before that would be used for passing data to and from DOS (for example, the contents of the command line used to invoke the program).</p>
<p>Note that COM files, by definition, cannot be 32-bit. Windows provides support for COM files via a special CPU mode.</p>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr>
<td class="mbox-image">
<div style="width: 52px;"><img alt="Information" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/32px-Information_icon.svg.png" title="Information" width="32" height="32" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/3/35/Information_icon.svg/48px-Information_icon.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/3/35/Information_icon.svg/64px-Information_icon.svg.png 2x" data-file-width="620" data-file-height="620"></div>
</td>
<td class="mbox-text" style="">Notice that MS-DOS COM files (short for "command" files) are not the same as <i>Component-Object Model</i> files, which are an object-oriented library technology.</td>
</tr>
</tbody></table>
<h2><span class="mw-headline" id="MS-DOS_EXE_Files">MS-DOS EXE Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=2" title="Edit section: MS-DOS EXE Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>One way MS-DOS compilers got around the 64K memory limitation was with the introduction of <b>memory models</b>. The basic concept is to cleverly set different segment registers in the x86 CPU (CS, DS, ES, SS) to point to the same or different segments, thus allowing varying degrees of access to memory. Typical memory models were:</p>
<dl>
<dt>tiny</dt>
<dd>All memory accesses are 16-bit (segment registers unchanged). Produces a .COM file instead of an .EXE file.</dd>
<dt>small</dt>
<dd>All memory accesses are 16-bit (segment registers unchanged).</dd>
<dt>compact</dt>
<dd>Data addresses include both segment and offset, reloading the DS or ES registers on access and allowing up to 1M of data. Code accesses don't change the CS register, allowing 64K of code.</dd>
<dt>medium</dt>
<dd>Code addresses include the segment address, reloading CS on access and allowing up to 1M of code. Data accesses don't change the DS and ES registers, allowing 64K of data.</dd>
<dt>large</dt>
<dd>Both code and data addresses are (segment, offset) pairs, always reloading the segment addresses. The whole 1M byte memory space is available for both code and data.</dd>
<dt>huge</dt>
<dd>Same as the large model, with additional arithmetic being generated by the compiler to allow access to arrays larger than 64K.</dd>
</dl>
<p>When looking at an EXE file, one has to decide which memory model was used to build that file.</p>
<h2><span class="mw-headline" id="PE_Files">PE Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=3" title="Edit section: PE Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>A <b>Portable Executable</b> (<b>PE</b>) file is the standard binary file format for an Executable or DLL under Windows NT, Windows 95, and Win32. The Win32 SDK contains a file, <i>winnt.h</i>, which declares various structs and variables used in the PE files. Some functions for manipulating PE files are also included in <i>imagehlp.dll</i>. PE files are broken down into various sections which can be examined.</p>
<h2><span class="mw-headline" id="Relative_Virtual_Addressing_.28RVA.29">Relative Virtual Addressing (RVA)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=4" title="Edit section: Relative Virtual Addressing (RVA)">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In a Windows environment, executable modules can be loaded at any point in memory, and are expected to run without problem. To allow multiple programs to be loaded at seemingly random locations in memory, PE files have adopted a tool called RVA: Relative Virtual Addresses. RVAs assume that the "base address" of where a module is loaded into memory is not known at compile time. So, PE files describe the location of data in memory as an <i>offset from the base address</i>, wherever that may be in memory.</p>
<p>Some processor instructions require the code itself to directly identify where in memory some data is. This is not possible when the location of the module in memory is not known at compile time. The solution to this problem is described in the section on "Relocations".</p>
<p>It is important to remember that the addresses obtained from a disassembly of a module will not always match up to the addresses seen in a debugger as the program is running.</p>
<h2><span class="mw-headline" id="File_Format">File Format</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=5" title="Edit section: File Format">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The PE portable executable file format includes a number of informational headers, and is arranged in the following format:</p>
<center>
<p><a href="https://commons.wikimedia.org/wiki/File:RevEngPEFile.JPG" class="image"><img alt="RevEngPEFile.JPG" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/RevEngPEFile.JPG" width="220" height="450" data-file-width="220" data-file-height="450"></a></p>
<p><b>The basic format of a Microsoft PE file</b></p>
</center>
<h3><span class="mw-headline" id="MS-DOS_header">MS-DOS header</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=6" title="Edit section: MS-DOS header">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Open any Win32 binary executable in a hex editor, and note what you see: The first 2 letters are <b>always</b> the letters "MZ", the initials of Mark Zbikowski, who created the first linker for DOS. To some people, the first few bytes in a file that determine the type of file are called the "magic number," although this book will not use that term, because there is no rule that states that the "magic number" needs to be a single number. Instead, we will use the term "File ID Tag", or simply, File ID. Sometimes this is also known as File Signature.</p>
<p>After the File ID, the hex editor will show several bytes of either random-looking symbols, or whitespace, before the human-readable string "This program cannot be run in DOS mode".</p>
<p>What is this?</p>
<center>
<p><a href="https://commons.wikimedia.org/wiki/File:RevEngDosHead.JPG" class="image"><img alt="RevEngDosHead.JPG" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/RevEngDosHead.JPG" width="625" height="128" data-file-width="625" data-file-height="128"></a></p>
<p><b>Hex Listing of an MS-DOS file header</b></p>
</center>
<p>What you are looking at is the MS-DOS header of the Win32 PE file. To ensure either a) backwards compatibility, or b) graceful decline of new file types, Microsoft has written a series of machine instructions(an example program is listed below the DOS header structure) into the head of each PE file. When a 32-bit Windows file is run in a 16-bit DOS environment, the program will display the error message: "This program cannot be run in DOS mode.", then terminate.</p>
<p>The DOS header is also known by some as the EXE header. Here is the DOS header presented as a C data structure:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre> <span class="k">struct</span> <span class="n">DOS_Header</span> 
 <span class="p">{</span>
<span class="c1">// short is 2 bytes, long is 4 bytes</span>
     <span class="kt">char</span> <span class="n">signature</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">"MZ"</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">lastsize</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">nblocks</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">nreloc</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">hdrsize</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">minalloc</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">maxalloc</span><span class="p">;</span>
     <span class="kt">void</span> <span class="o">*</span><span class="n">ss</span><span class="p">;</span>
     <span class="kt">void</span> <span class="o">*</span><span class="n">sp</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">checksum</span><span class="p">;</span>
     <span class="kt">void</span> <span class="o">*</span><span class="n">ip</span><span class="p">;</span>
     <span class="kt">void</span> <span class="o">*</span><span class="n">cs</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">relocpos</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">noverlay</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
     <span class="kt">short</span> <span class="n">oem_id</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">oem_info</span><span class="p">;</span>
     <span class="kt">short</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
     <span class="kt">long</span>  <span class="n">e_lfanew</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
<p>After the DOS header there is a stub program mentioned in the paragraph above the DOS header structure. Listed below is a commented example of that program, it was taken from a program compiled with GCC.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="err">;</span><span class="c"># Using NASM with Intel syntax</span>

<span class="nf">push</span> <span class="no">cs</span> <span class="err">;</span><span class="c"># Push CS onto the stack</span>
<span class="nf">pop</span> <span class="no">ds</span>  <span class="err">;</span><span class="c"># Set DS to CS</span>

<span class="nf">mov</span> <span class="no">dx</span><span class="p">,</span><span class="no">message</span> <span class="err">;</span> <span class="no">point</span> <span class="no">to</span> <span class="no">our</span> <span class="no">message</span> <span class="err">"</span><span class="no">This</span> <span class="no">program</span> <span class="no">cannot</span> <span class="no">be</span> <span class="no">run</span> <span class="no">in</span> <span class="no">DOS</span> <span class="no">mode.</span><span class="err">"</span><span class="p">,</span> <span class="mi">0x0d</span><span class="p">,</span> <span class="mi">0x0d</span><span class="p">,</span> <span class="mi">0x0a</span><span class="p">,</span> <span class="err">'</span><span class="no">$</span><span class="err">'</span>
<span class="nf">mov</span> <span class="no">ah</span><span class="p">,</span> <span class="mi">09</span>  
<span class="no">int</span> <span class="mi">0x21</span> <span class="err">;</span><span class="c"># when AH = 9, DOS interrupt to write a string</span>

<span class="err">;</span><span class="c"># terminate the program</span>
<span class="nf">mov</span> <span class="no">ax</span><span class="p">,</span><span class="mi">0x4c01</span> 
<span class="no">int</span> <span class="mi">0x21</span>

<span class="nf">message</span> <span class="no">db</span> <span class="err">"</span><span class="no">This</span> <span class="no">program</span> <span class="no">cannot</span> <span class="no">be</span> <span class="no">run</span> <span class="no">in</span> <span class="no">DOS</span> <span class="no">mode.</span><span class="err">"</span><span class="p">,</span> <span class="mi">0x0d</span><span class="p">,</span> <span class="mi">0x0d</span><span class="p">,</span> <span class="mi">0x0a</span><span class="p">,</span> <span class="err">'</span><span class="no">$</span><span class="err">'</span>
</pre></div>
<h3><span class="mw-headline" id="PE_Header">PE Header</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=7" title="Edit section: PE Header">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>At offset 60 (0x3C) from the beginning of the DOS header is a pointer to the Portable Executable (PE) File header (e_lfanew in MZ structure). DOS will print the error message and terminate, but Windows will follow this pointer to the next batch of information.</p>
<center>
<p><a href="https://commons.wikimedia.org/wiki/File:RevEngPeSig.JPG" class="image"><img alt="RevEngPeSig.JPG" src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/RevEngPeSig.JPG" width="625" height="181" data-file-width="625" data-file-height="181"></a></p>
<p><b>Hex Listing of a PE signature, and the pointer to it</b></p>
</center>
<p>The PE header consists only of a File ID signature, with the value "PE\0\0" where each '\0' character is an ASCII NUL character. This signature shows that a) this file is a legitimate PE file, and b) the byte order of the file. Byte order will not be considered in this chapter, and all PE files are assumed to be in "little endian" format.</p>
<p>The first big chunk of information lies in the COFF header, directly after the PE signature.</p>
<h3><span class="mw-headline" id="COFF_Header">COFF Header</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=8" title="Edit section: COFF Header">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The COFF header is present in both COFF object files (before they are linked) and in PE files where it is known as the "File header". The COFF header has some information that is useful to an executable, and some information that is more useful to an object file.</p>
<p>Here is the COFF header, presented as a C data structure:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre> <span class="k">struct</span> <span class="n">COFFHeader</span>
 <span class="p">{</span>
    <span class="kt">short</span> <span class="n">Machine</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">NumberOfSections</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">TimeDateStamp</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">PointerToSymbolTable</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">NumberOfSymbols</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">SizeOfOptionalHeader</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">Characteristics</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
<dl>
<dt>Machine&nbsp;</dt>
<dd>This field determines what machine the file was compiled for. A hex value of 0x14C (332 in decimal) is the code for an Intel 80386.</dd>
</dl>
<p>Here's a list of possible values it can have.</p>
<table class="wikitable">
<tbody><tr>
<td>Value</td>
<td>Description</td>
</tr>
<tr>
<td>0x14c</td>
<td>Intel 386</td>
</tr>
<tr>
<td>0x8664</td>
<td>x64</td>
</tr>
<tr>
<td>0x162</td>
<td>MIPS R3000</td>
</tr>
<tr>
<td>0x168</td>
<td>MIPS R10000</td>
</tr>
<tr>
<td>0x169</td>
<td>MIPS little endian WCI v2</td>
</tr>
<tr>
<td>0x183</td>
<td>old Alpha AXP</td>
</tr>
<tr>
<td>0x184</td>
<td>Alpha AXP</td>
</tr>
<tr>
<td>0x1a2</td>
<td>Hitachi SH3</td>
</tr>
<tr>
<td>0x1a3</td>
<td>Hitachi SH3 DSP</td>
</tr>
<tr>
<td>0x1a6</td>
<td>Hitachi SH4</td>
</tr>
<tr>
<td>0x1a8</td>
<td>Hitachi SH5</td>
</tr>
<tr>
<td>0x1c0</td>
<td>ARM little endian</td>
</tr>
<tr>
<td>0x1c2</td>
<td>Thumb</td>
</tr>
<tr>
<td>0x1d3</td>
<td>Matsushita AM33</td>
</tr>
<tr>
<td>0x1f0</td>
<td>PowerPC little endian</td>
</tr>
<tr>
<td>0x1f1</td>
<td>PowerPC with floating point support</td>
</tr>
<tr>
<td>0x200</td>
<td>Intel IA64</td>
</tr>
<tr>
<td>0x266</td>
<td>MIPS16</td>
</tr>
<tr>
<td>0x268</td>
<td>Motorola 68000 series</td>
</tr>
<tr>
<td>0x284</td>
<td>Alpha AXP 64-bit</td>
</tr>
<tr>
<td>0x366</td>
<td>MIPS with FPU</td>
</tr>
<tr>
<td>0x466</td>
<td>MIPS16 with FPU</td>
</tr>
<tr>
<td>0xebc</td>
<td>EFI Byte Code</td>
</tr>
<tr>
<td>0x8664</td>
<td>AMD AMD64</td>
</tr>
<tr>
<td>0x9041</td>
<td>Mitsubishi M32R little endian</td>
</tr>
<tr>
<td>0xc0ee</td>
<td>clr pure MSIL</td>
</tr>
</tbody></table>
<dl>
<dt>NumberOfSections&nbsp;</dt>
<dd>The number of sections that are described at the end of the PE headers.</dd>
<dt>TimeDateStamp&nbsp;</dt>
<dd>32 bit time at which this header was generated: is used in the process of "Binding", see below.</dd>
<dt>SizeOfOptionalHeader&nbsp;</dt>
<dd>this field shows how long the "PE Optional Header" is that follows the COFF header.</dd>
<dt>Characteristics&nbsp;</dt>
<dd>This is a field of bit flags, that show some characteristics of the file.</dd>
</dl>
<table class="wikitable">
<tbody><tr>
<td>Value</td>
<td>Description</td>
</tr>
<tr>
<td>0x02</td>
<td>Executable file</td>
</tr>
<tr>
<td>0x200</td>
<td>file is non-relocatable (addresses are absolute, not RVA)</td>
</tr>
<tr>
<td>0x2000</td>
<td>File is a DLL Library, not an EXE</td>
</tr>
</tbody></table>
<h3><span class="mw-headline" id="PE_Optional_Header">PE Optional Header</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=9" title="Edit section: PE Optional Header">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The "PE Optional Header" is not "optional" per se, because it is required in Executable files, but not in COFF object files. The Optional header includes lots and lots of information that can be used to pick apart the file structure, and obtain some useful information about it.</p>
<p>The PE Optional Header occurs directly after the COFF header, and some sources even show the two headers as being part of the same structure. This wikibook separates them out for convenience.</p>
<p>Here is the PE Optional Header presented as a C data structure:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre> <span class="k">struct</span> <span class="n">PEOptHeader</span>
 <span class="p">{</span>
<span class="cm">/*</span>
<span class="cm">char is 1 byte</span>
<span class="cm">short is 2 bytes</span>
<span class="cm">long is 4 bytes</span>
<span class="cm">*/</span>
    <span class="kt">short</span> <span class="n">signature</span><span class="p">;</span> <span class="c1">//decimal number 267 for 32 bit, 523 for 64 bit, and 263 for a ROM image. </span>
    <span class="kt">char</span> <span class="n">MajorLinkerVersion</span><span class="p">;</span> 
    <span class="kt">char</span> <span class="n">MinorLinkerVersion</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfCode</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfInitializedData</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfUninitializedData</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">AddressOfEntryPoint</span><span class="p">;</span>  <span class="c1">//The RVA of the code entry point</span>
    <span class="kt">long</span> <span class="n">BaseOfCode</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">BaseOfData</span><span class="p">;</span>
    <span class="cm">/*The next 21 fields are an extension to the COFF optional header format*/</span>
    <span class="kt">long</span> <span class="n">ImageBase</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SectionAlignment</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">FileAlignment</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MajorOSVersion</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MinorOSVersion</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MajorImageVersion</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MinorImageVersion</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MajorSubsystemVersion</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">MinorSubsystemVersion</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">Win32VersionValue</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfImage</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfHeaders</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">Checksum</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">Subsystem</span><span class="p">;</span>
    <span class="kt">short</span> <span class="n">DLLCharacteristics</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfStackReserve</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfStackCommit</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfHeapReserve</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">SizeOfHeapCommit</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">LoaderFlags</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">NumberOfRvaAndSizes</span><span class="p">;</span>
    <span class="n">data_directory</span> <span class="n">DataDirectory</span><span class="p">[</span><span class="n">NumberOfRvaAndSizes</span><span class="p">];</span>     <span class="c1">//Can have any number of elements, matching the number in NumberOfRvaAndSizes.</span>
 <span class="p">}</span>                                        <span class="c1">//However, it is always 16 in PE files.</span>
</pre></div>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="cm">/*</span>
<span class="cm">long is 4 bytes</span>
<span class="cm">*/</span>
 <span class="k">struct</span> <span class="n">data_directory</span>
 <span class="p">{</span> 
    <span class="kt">long</span> <span class="n">VirtualAddress</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">Size</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
<dl>
<dt>Signature&nbsp;</dt>
<dd>Contains a signature that identifies the image.</dd>
</dl>
<table class="wikitable">
<tbody><tr>
<th>Constant Name</th>
<th>Value</th>
<th>Description</th>
</tr>
<tr>
<td>IMAGE_NT_OPTIONAL_HDR32_MAGIC</td>
<td>0x10b</td>
<td>32 bit executable image.</td>
</tr>
<tr>
<td>IMAGE_NT_OPTIONAL_HDR64_MAGIC</td>
<td>0x20b</td>
<td>64 bit executable image</td>
</tr>
<tr>
<td>IMAGE_ROM_OPTIONAL_HDR_MAGIC</td>
<td>0x107</td>
<td>ROM image</td>
</tr>
</tbody></table>
<dl>
<dt>MajorLinkerVersion&nbsp;</dt>
<dd>The major version number of the linker.</dd>
<dt>MinorLinkerVersion&nbsp;</dt>
<dd>The minor version number of the linker.</dd>
<dt>SizeOfCode&nbsp;</dt>
<dd>The size of the code section, in bytes, or the sum of all such sections if there are multiple code sections.</dd>
<dt>SizeOfInitializedData&nbsp;</dt>
<dd>The size of the initialized data section, in bytes, or the sum of all such sections if there are multiple initialized data sections.</dd>
<dt>SizeOfUninitializedData&nbsp;</dt>
<dd>The size of the uninitialized data section, in bytes, or the sum of all such sections if there are multiple uninitialized data sections.</dd>
<dt>AddressOfEntryPoint&nbsp;</dt>
<dd>A pointer to the entry point function, relative to the image base address. For executable files, this is the starting address. For device drivers, this is the address of the initialization function. The entry point function is optional for DLLs. When no entry point is present, this member is zero.</dd>
<dt>BaseOfCode&nbsp;</dt>
<dd>A pointer to the beginning of the code section, relative to the image base.</dd>
<dt>BaseOfData&nbsp;</dt>
<dd>A pointer to the beginning of the data section, relative to the image base.</dd>
<dt>ImageBase&nbsp;</dt>
<dd>The preferred address of the first byte of the image when it is loaded in memory. This value is a multiple of 64K bytes. The default value for DLLs is 0x10000000. The default value for applications is 0x00400000, except on Windows CE where it is 0x00010000.</dd>
<dt>SectionAlignment&nbsp;</dt>
<dd>The alignment of sections loaded in memory, in bytes. This value must be greater than or equal to the FileAlignment member. The default value is the page size for the system.</dd>
<dt>FileAlignment&nbsp;</dt>
<dd>The alignment of the raw data of sections in the image file, in bytes. The value should be a power of 2 between 512 and 64K (inclusive). The default is 512. If the SectionAlignment member is less than the system page size, this member must be the same as SectionAlignment.</dd>
<dt>MajorOSVersion&nbsp;</dt>
<dd>The major version number of the required operating system.</dd>
<dt>MinorOSVersion&nbsp;</dt>
<dd>The minor version number of the required operating system.</dd>
<dt>MajorImageVersion&nbsp;</dt>
<dd>The major version number of the image.</dd>
<dt>MinorImageVersion&nbsp;</dt>
<dd>The minor version number of the image.</dd>
<dt>MajorSubsystemVersion&nbsp;</dt>
<dd>The major version number of the subsystem.</dd>
<dt>MinorSubsystemVersion&nbsp;</dt>
<dd>The minor version number of the subsystem.</dd>
<dt>Win32VersionValue&nbsp;</dt>
<dd>This member is reserved and must be 0.</dd>
<dt>SizeOfImage&nbsp;</dt>
<dd>The size of the image, in bytes, including all headers. Must be a multiple of SectionAlignment.</dd>
<dt>SizeOfHeaders&nbsp;</dt>
<dd>The combined size of the following items, rounded to a multiple of the value specified in the FileAlignment member.</dd>
</dl>
<ul>
<li>e_lfanew member of DOS_Header</li>
<li>4 byte signature</li>
<li>size of COFFHeader</li>
<li>size of optional header</li>
<li>size of all section headers</li>
</ul>
<dl>
<dt>CheckSum&nbsp;</dt>
<dd>The image file checksum. The following files are validated at load time: all drivers, any DLL loaded at boot time, and any DLL loaded into a critical system process.</dd>
<dt>Subsystem&nbsp;</dt>
<dd>The Subsystem that will be invoked to run the executable</dd>
</dl>
<table class="wikitable">
<tbody><tr>
<th>Constant Name</th>
<th>Value</th>
<th>Description</th>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_UNKNOWN</b></td>
<td>0</td>
<td>Unknown subsystem</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_NATIVE</b></td>
<td>1</td>
<td>No subsystem required (device drivers and native system processes)</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_WINDOWS_GUI</b></td>
<td>2</td>
<td>Windows graphical user interface (GUI) subsystem</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_WINDOWS_CUI</b></td>
<td>3</td>
<td>Windows character-mode user interface (CUI) subsystem</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_OS2_CUI</b></td>
<td>5</td>
<td>OS/2 CUI subsystem</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_POSIX_CUI</b></td>
<td>7</td>
<td>POSIX CUI subsystem</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_WINDOWS_CE_GUI</b></td>
<td>9</td>
<td>Windows CE system</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_EFI_APPLICATION</b></td>
<td>10</td>
<td>Extensible Firmware Interface (EFI) application</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER</b></td>
<td>11</td>
<td>EFI driver with boot services</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER</b></td>
<td>12</td>
<td>EFI driver with run-time services</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_EFI_ROM</b></td>
<td>13</td>
<td>EFI ROM image</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_XBOX</b></td>
<td>14</td>
<td>Xbox system</td>
</tr>
<tr>
<td><b>IMAGE_SUBSYSTEM_WINDOWS_BOOT_APPLICATION</b></td>
<td>16</td>
<td>Boot application</td>
</tr>
</tbody></table>
<dl>
<dt>DLLCharacteristics&nbsp;</dt>
<dd>The DLL characteristics of the image</dd>
</dl>
<table class="wikitable">
<tbody><tr>
<th>Constant Name</th>
<th>Value</th>
<th>Description</th>
</tr>
<tr>
<td>No constant name</td>
<td>0x0001</td>
<td>Reserved</td>
</tr>
<tr>
<td>No constant name</td>
<td>0x0002</td>
<td>Reserved</td>
</tr>
<tr>
<td>No constant name</td>
<td>0x0004</td>
<td>Reserved</td>
</tr>
<tr>
<td>No constant name</td>
<td>0x0008</td>
<td>Reserved</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</b></td>
<td>0x0040</td>
<td>The DLL can be relocated at load time</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY</b></td>
<td>0x0080</td>
<td>Code integrity checks are forced</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_NX_COMPAT</b></td>
<td>0x0100</td>
<td>The image is compatible with data execution prevention (DEP)</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_NO_ISOLATION</b></td>
<td>0x0200</td>
<td>The image is isolation aware, but should not be isolated</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_NO_SEH</b></td>
<td>0x0400</td>
<td>The image does not use structured exception handling (SEH). No handlers can be called in this image</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_NO_BIND</b></td>
<td>0x0800</td>
<td>Do not bind the image</td>
</tr>
<tr>
<td>No constant name</td>
<td>0x1000</td>
<td>Reserved</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_WDM_DRIVER</b></td>
<td>0x2000</td>
<td>A WDM driver</td>
</tr>
<tr>
<td>No constant name</td>
<td>0x4000</td>
<td>Reserved</td>
</tr>
<tr>
<td><b>IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE</b></td>
<td>0x8000</td>
<td>The image is terminal server aware</td>
</tr>
</tbody></table>
<dl>
<dt>SizeOfStackReserve&nbsp;</dt>
<dd>The number of bytes to reserve for the stack. Only the memory specified by the SizeOfStackCommit member is committed at load time; the rest is made available one page at a time until this reserve size is reached.</dd>
<dt>SizeOfStackCommit&nbsp;</dt>
<dd>The number of bytes to commit for the stack.</dd>
<dt>SizeOfHeapReserve&nbsp;</dt>
<dd>The number of bytes to reserve for the local heap. Only the memory specified by the SizeOfHeapCommit member is committed at load time; the rest is made available one page at a time until this reserve size is reached.</dd>
<dt>SizeOfHeapCommit&nbsp;</dt>
<dd>The number of bytes to commit for the local heap.</dd>
<dt>LoaderFlags&nbsp;</dt>
<dd>This member is obsolete.</dd>
<dt>NumberOfRvaAndSizes&nbsp;</dt>
<dd>The number of directory entries in the remainder of the optional header. Each entry describes a location and size.</dd>
<dt>DataDirectory&nbsp;</dt>
<dd>Possibly the most interesting member of this structure. Provides RVAs and sizes which locate various data structures, which are used for setting up the execution environment of a module. The details of what these structures do exist in other sections of this page. The most interesting entries in DataDirectory are as follows, Export Directory, Import Directory, Resource Directory, and the Bound Import directory. Note that the offsets in bytes are relative to the beginning of the optional header.</dd>
</dl>
<table class="wikitable">
<tbody><tr>
<th>Constant Name</th>
<th>Value</th>
<th>Description</th>
<th>Offset PE(32 bit)</th>
<th>Offset PE32+(64 bit)</th>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_EXPORT</b></td>
<td>0</td>
<td>Export Directory</td>
<td>96</td>
<td>112</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_IMPORT</b></td>
<td>1</td>
<td>Import Directory</td>
<td>104</td>
<td>120</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_RESOURCE</b></td>
<td>2</td>
<td>Resource Directory</td>
<td>112</td>
<td>128</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_EXCEPTION</b></td>
<td>3</td>
<td>Exception Directory</td>
<td>120</td>
<td>136</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_SECURITY</b></td>
<td>4</td>
<td>Security Directory</td>
<td>128</td>
<td>144</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_BASERELOC</b></td>
<td>5</td>
<td>Base Relocation Table</td>
<td>136</td>
<td>152</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_DEBUG</b></td>
<td>6</td>
<td>Debug Directory</td>
<td>144</td>
<td>160</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_ARCHITECTURE</b></td>
<td>7</td>
<td>Architecture specific data</td>
<td>152</td>
<td>168</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_GLOBALPTR</b></td>
<td>8</td>
<td>Global pointer register relative virtual address</td>
<td>160</td>
<td>176</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_TLS</b></td>
<td>9</td>
<td>Thread Local Storage directory</td>
<td>168</td>
<td>184</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</b></td>
<td>10</td>
<td>Load Configuration directory</td>
<td>176</td>
<td>192</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</b></td>
<td>11</td>
<td>Bound Import directory</td>
<td>184</td>
<td>200</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_IAT</b></td>
<td>12</td>
<td>Import Address Table</td>
<td>192</td>
<td>208</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</b></td>
<td>13</td>
<td>Delay Import table</td>
<td>200</td>
<td>216</td>
</tr>
<tr>
<td><b>IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</b></td>
<td>14</td>
<td>COM descriptor table</td>
<td>208</td>
<td>224</td>
</tr>
<tr>
<td>No constant name</td>
<td>15</td>
<td>Reserved</td>
<td>216</td>
<td>232</td>
</tr>
</tbody></table>
<h2><span class="mw-headline" id="Code_Sections">Code Sections</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=10" title="Edit section: Code Sections">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The PE Header defines the number of sections in the executable file. Each section definition is 40 bytes in length. Below is an example hex from a program I am writing:</p>
<pre>2E746578_74000000_00100000_00100000_A8050000 .text
00040000_00000000_00000000_00000000_20000000
2E646174_61000000_00100000_00200000_86050000 .data
000A0000_00000000_00000000_00000000_40000000
2E627373_00000000_00200000_00300000_00000000 .bss
00000000_00000000_00000000_00000000_80000000
</pre>
<p>The structure of the section descriptor is as follows:</p>
<pre>Offset Length   Purpose
------ -------  ------------------------------------------------------------------
 0x00   8 bytes Section Name - in the above example the names are .text .data .bss
 0x08   4 bytes Size of the section once it is loaded to memory
 0x0C   4 bytes RVA (location) of section once it is loaded to memory
 0x10   4 bytes Physical size of section on disk
 0x14   4 bytes Physical location of section on disk (from start of disk image)
 0x18  12 bytes Reserved (usually zero) (used in object formats)
 0x24   4 bytes Section flags
</pre>
<p>A PE loader will place the sections of the executable image at the locations specified by these section descriptors (relative to the base address) and usually the alignment is 0x1000, which matches the size of pages on the x86.</p>
<p>Common sections are:</p>
<ol>
<li>.text/.code/CODE/TEXT - Contains executable code (machine instructions)</li>
<li>.testbss/TEXTBSS - Present if Incremental Linking is enabled</li>
<li>.data/.idata/DATA/IDATA - Contains initialised data</li>
<li>.bss/BSS - Contains uninitialised data</li>
</ol>
<h3><span class="mw-headline" id="Section_Flags">Section Flags</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=11" title="Edit section: Section Flags">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The section flags is a 32-bit bit field (each bit in the value represents a certain thing). Here are the constants defined in the WINNT.H file for the meaning of the flags:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="cp">#define IMAGE_SCN_TYPE_NO_PAD                0x00000008  </span><span class="c1">// Reserved.</span>
<span class="cp">#define IMAGE_SCN_CNT_CODE                   0x00000020  </span><span class="c1">// Section contains code.</span>
<span class="cp">#define IMAGE_SCN_CNT_INITIALIZED_DATA       0x00000040  </span><span class="c1">// Section contains initialized data.</span>
<span class="cp">#define IMAGE_SCN_CNT_UNINITIALIZED_DATA     0x00000080  </span><span class="c1">// Section contains uninitialized data.</span>
<span class="cp">#define IMAGE_SCN_LNK_OTHER                  0x00000100  </span><span class="c1">// Reserved.</span>
<span class="cp">#define IMAGE_SCN_LNK_INFO                   0x00000200  </span><span class="c1">// Section contains comments or some  other type of information.</span>
<span class="cp">#define IMAGE_SCN_LNK_REMOVE                 0x00000800  </span><span class="c1">// Section contents will not become part of image.</span>
<span class="cp">#define IMAGE_SCN_LNK_COMDAT                 0x00001000  </span><span class="c1">// Section contents comdat.</span>
<span class="cp">#define IMAGE_SCN_NO_DEFER_SPEC_EXC          0x00004000  </span><span class="c1">// Reset speculative exceptions handling bits in the TLB entries for this section.</span>
<span class="cp">#define IMAGE_SCN_GPREL                      0x00008000  </span><span class="c1">// Section content can be accessed relative to GP</span>
<span class="cp">#define IMAGE_SCN_MEM_FARDATA                0x00008000</span>
<span class="cp">#define IMAGE_SCN_MEM_PURGEABLE              0x00020000</span>
<span class="cp">#define IMAGE_SCN_MEM_16BIT                  0x00020000</span>
<span class="cp">#define IMAGE_SCN_MEM_LOCKED                 0x00040000</span>
<span class="cp">#define IMAGE_SCN_MEM_PRELOAD                0x00080000</span>
<span class="cp">#define IMAGE_SCN_ALIGN_1BYTES               0x00100000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_2BYTES               0x00200000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_4BYTES               0x00300000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_8BYTES               0x00400000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_16BYTES              0x00500000  </span><span class="c1">// Default alignment if no others are specified.</span>
<span class="cp">#define IMAGE_SCN_ALIGN_32BYTES              0x00600000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_64BYTES              0x00700000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_128BYTES             0x00800000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_256BYTES             0x00900000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_512BYTES             0x00A00000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_1024BYTES            0x00B00000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_2048BYTES            0x00C00000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_4096BYTES            0x00D00000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_8192BYTES            0x00E00000  </span><span class="c1">//</span>
<span class="cp">#define IMAGE_SCN_ALIGN_MASK                 0x00F00000</span>
<span class="cp">#define IMAGE_SCN_LNK_NRELOC_OVFL            0x01000000  </span><span class="c1">// Section contains extended relocations.</span>
<span class="cp">#define IMAGE_SCN_MEM_DISCARDABLE            0x02000000  </span><span class="c1">// Section can be discarded.</span>
<span class="cp">#define IMAGE_SCN_MEM_NOT_CACHED             0x04000000  </span><span class="c1">// Section is not cachable.</span>
<span class="cp">#define IMAGE_SCN_MEM_NOT_PAGED              0x08000000  </span><span class="c1">// Section is not pageable.</span>
<span class="cp">#define IMAGE_SCN_MEM_SHARED                 0x10000000  </span><span class="c1">// Section is shareable.</span>
<span class="cp">#define IMAGE_SCN_MEM_EXECUTE                0x20000000  </span><span class="c1">// Section is executable.</span>
<span class="cp">#define IMAGE_SCN_MEM_READ                   0x40000000  </span><span class="c1">// Section is readable.</span>
<span class="cp">#define IMAGE_SCN_MEM_WRITE                  0x80000000  </span><span class="c1">// Section is writeable.</span>
</pre></div>
<h2><span class="mw-headline" id="Imports_and_Exports_-_Linking_to_other_modules">Imports and Exports - Linking to other modules</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=12" title="Edit section: Imports and Exports - Linking to other modules">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="What_is_linking.3F">What is linking?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=13" title="Edit section: What is linking?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Whenever a developer writes a program, there are a number of subroutines and functions which are expected to be implemented already, saving the writer the hassle of having to write out more code or work with complex data structures. Instead, the coder need only declare one call to the subroutine, and the linker will decide what happens next.</p>
<p>There are two types of linking that can be used: static and dynamic. Static uses a library of precompiled functions. This precompiled code can be inserted into the final executable to implement a function, saving the programmer a lot of time. In contrast, dynamic linking allows subroutine code to reside in a different file (or <i>module</i>), which is loaded at runtime by the operating system. This is also known as a "Dynamically linked library", or DLL. A <i>library</i> is a module containing a series of functions or values that can be <i>exported</i>. This is different from the term <i>executable</i>, which <i>imports</i> things from libraries to do what it wants. From here on, "module" means any file of PE format, and a "Library" is any module which exports and imports functions and values.</p>
<p>Dynamically linking has the following benefits:</p>
<ul>
<li>It saves disk space, if more than one executable links to the library module</li>
<li>Allows instant updating of routines, without providing new executables for all applications</li>
<li>Can save space in memory by mapping the code of a library into more than one process</li>
<li>Increases abstraction of implementation. The method by which an action is achieved can be modified without the need for reprogramming of applications. This is extremely useful for backward compatibility with operating systems.</li>
</ul>
<p>This section discusses how this is achieved using the PE file format. An important point to note at this point is that <i>anything</i> can be imported or exported between modules, including variables as well as subroutines.</p>
<h3><span class="mw-headline" id="Loading">Loading</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=14" title="Edit section: Loading">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The downside of dynamically linking modules together is that, at runtime, the software which is initialising an executable must link these modules together. For various reasons, you cannot declare that "The function in this dynamic library will always exist in memory <i>here</i>". If that memory address is unavailable or the library is updated, the function will no longer exist there, and the application trying to use it will break. Instead, each module (library or executable) must declare what functions or values it <i>exports</i> to other modules, and also what it wishes to <i>import</i> from other modules.</p>
<p>As said above, a module cannot declare where in memory it expects a function or value to be. Instead, it declares where <i>in its own memory</i> it expects to find a <b>pointer</b> to the value it wishes to import. This permits the module to address any imported value, wherever it turns up in memory.</p>
<h2><span class="mw-headline" id="Exports">Exports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=15" title="Edit section: Exports">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><i>Exports</i> are functions and values in one module that have been declared to be shared with other modules. This is done through the use of the "Export Directory", which is used to translate between the name of an export (or "Ordinal", see below), and a location in memory where the code or data can be found. The start of the export directory is identified by the IMAGE_DIRECTORY_ENTRY_EXPORT entry of the resource directory. All export data must exist in the same section. The directory is headed by the following structure:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_EXPORT_DIRECTORY</span> <span class="p">{</span>
	<span class="kt">long</span> <span class="n">Characteristics</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">TimeDateStamp</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">MajorVersion</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">MinorVersion</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">Name</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">Base</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">NumberOfFunctions</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">NumberOfNames</span><span class="p">;</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">AddressOfFunctions</span><span class="p">;</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">AddressOfNames</span><span class="p">;</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">AddressOfNameOrdinals</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>The "Characteristics" value is generally unused, TimeDateStamp describes the time the export directory was generated, MajorVersion and MinorVersion should describe the version details of the directory, but their nature is undefined. These values have little or no impact on the actual exports themselves. The "Name" value is an RVA to a zero terminated ASCII string, the name of this library name, or module.</p>
<h4><span class="mw-headline" id="Names_and_Ordinals">Names and Ordinals</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=16" title="Edit section: Names and Ordinals">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Each exported value has both a name and an "ordinal" (a kind of index). The actual exports themselves are described through AddressOfFunctions, which is an RVA to an array of RVAs, each pointing to a different function or value to be exported. The size of this array is in the value NumberOfFunctions. Each of these functions has an ordinal. The "Base" value is used as the ordinal of the first export, and the next RVA in the array is Base+1, and so forth.</p>
<p>Each entry in the AddressOfFunctions array is identified by a name, found through the RVA AddressOfNames. The data where AddressOfNames points to is an array of RVAs, of the size NumberOfNames. Each RVA points to a zero terminated ASCII string, each being the name of an export. There is also a second array, pointed to by the RVA in AddressOfNameOrdinals. This is also of size NumberOfNames, but each value is a 16 bit word, each value being an ordinal. These two arrays are parallel and are used to get an export value from AddressOfFunctions. To find an export by name, search the AddressOfNames array for the correct string and then take the corresponding ordinal from the AddressOfNameOrdinals array. This ordinal is then used to get an index to a value in AddressOfFunctions.</p>
<h4><span class="mw-headline" id="Forwarding">Forwarding</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=17" title="Edit section: Forwarding">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>As well as being able to export functions and values in a module, the export directory can <i>forward</i> an export to another library. This allows more flexibility when re-organising libraries: perhaps some functionality has branched into another module. If so, an export can be forwarded to that library, instead of messy reorganising inside the original module.</p>
<p>Forwarding is achieved by making an RVA in the AddressOfFunctions array point into the section which contains the export directory, something that normal exports should not do. At that location, there should be a zero terminated ASCII string of format "LibraryName.ExportName" for the appropriate place to forward this export to.</p>
<h2><span class="mw-headline" id="Imports">Imports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=18" title="Edit section: Imports">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The other half of dynamic linking is importing functions and values into an executable or other module. Before runtime, compilers and linkers do not know where in memory a value that needs to be imported could exist. The import table solves this by creating an array of pointers at runtime, each one pointing to the memory location of an imported value. This array of pointers exists inside of the module at a defined RVA location. In this way, the linker can use addresses inside of the module to access values outside of it.</p>
<h3><span class="mw-headline" id="The_Import_directory">The Import directory</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=19" title="Edit section: The Import directory">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The start of the import directory is pointed to by both the IMAGE_DIRECTORY_ENTRY_IAT and IMAGE_DIRECTORY_ENTRY_IMPORT entries of the resource directory (the reason for this is uncertain). At that location, there is an array of IMAGE_IMPORT_DESCRIPTOR structures. Each of these identify a library or module that has a value we need to import. The array continues until an entry where all the values are zero. The structure is as follows:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_IMPORT_DESCRIPTOR</span> <span class="p">{</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">OriginalFirstThunk</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">TimeDateStamp</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">ForwarderChain</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">Name</span><span class="p">;</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">FirstThunk</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>The TimeDateStamp is relevant to the act of "Binding", see below. The Name value is an RVA to an ASCII string, naming the library to import. ForwarderChain will be explained later. The only thing of interest at this point, are the RVAs OriginalFirstThunk and FirstThunk. Both these values point to arrays of RVAs, each of which point to a IMAGE_IMPORT_BY_NAMES struct. The arrays are terminated with an entry that is equal to zero. These two arrays are parallel and point to the same structure, in the same order. The reason for this will become apparent shortly.</p>
<p>Each of these IMAGE_IMPORT_BY_NAMES structs has the following form:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_IMPORT_BY_NAME</span> <span class="p">{</span>
	<span class="kt">short</span> <span class="n">Hint</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">Name</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
<p>"Name" is an ASCII string of any size that names the value to be imported. This is used when looking up a value in the export directory (see above) through the AddressOfNames array. The "Hint" value is an index into the AddressOfNames array; to save searching for a string, the loader first checks the AddressOfNames entry corresponding to "Hint".</p>
<p><br>
To summarise: The import table consists of a large array of IMAGE_IMPORT_DESCRIPTORs, terminated by an all-zero entry. These descriptors identify a library to import things from. There are then two parallel RVA arrays, each pointing at IMAGE_IMPORT_BY_NAME structures, which identify a specific value to be imported.</p>
<h3><span class="mw-headline" id="Imports_at_runtime">Imports at runtime</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=20" title="Edit section: Imports at runtime">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Using the above import directory at runtime, the loader finds the appropriate modules, loads them into memory, and seeks the correct export. However, to be able to use the export, a pointer to it must be stored somewhere in the importing module's memory. This is why there are two parallel arrays, OriginalFirstThunk and FirstThunk, identifying IMAGE_IMPORT_BY_NAME structures. Once an imported value has been resolved, the pointer to it is stored in the FirstThunk array. It can then be used at runtime to address imported values.</p>
<h3><span class="mw-headline" id="Bound_imports">Bound imports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=21" title="Edit section: Bound imports">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The PE file format also supports a peculiar feature known as "binding". The process of loading and resolving import addresses can be time consuming, and in some situations this is to be avoided. If a developer is fairly certain that a library is not going to be updated or changed, then the addresses in memory of imported values will not change each time the application is loaded. So, the import address can be precomputed and stored in the FirstThunk array <i>before</i> runtime, allowing the loader to skip resolving the imports - the imports are "bound" to a particular memory location. However, if the versions numbers between modules do not match, or the imported library needs to be relocated, the loader will assume the bound addresses are invalid, and resolve the imports anyway.</p>
<p>The "TimeDateStamp" member of the import directory entry for a module controls binding; if it is set to zero, then the import directory is not bound. If it is non-zero, then it is bound to another module. However, the TimeDateStamp in the import table must match the TimeDateStamp in the bound module's FileHeader, otherwise the bound values will be discarded by the loader.</p>
<h4><span class="mw-headline" id="Forwarding_and_binding">Forwarding and binding</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=22" title="Edit section: Forwarding and binding">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Binding can of course be a problem if the bound library / module forwards its exports to another module. In these cases, the non-forwarded imports can be bound, but the values which get forwarded must be identified so the loader can resolve them. This is done through the ForwarderChain member of the import descriptor. The value of "ForwarderChain" is an index into the FirstThunk and OriginalFirstThunk arrays. The OriginalFirstThunk for that index identifies the IMAGE_IMPORT_BY_NAME structure for a import that needs to be resolved, and the FirstThunk for that index is the index of another entry that needs to be resolved. This continues until the FirstThunk value is -1, indicating no more forwarded values to import.</p>
<h2><span class="mw-headline" id="Resources">Resources</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=23" title="Edit section: Resources">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Resource_structures">Resource structures</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=24" title="Edit section: Resource structures">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Resources are data items in modules which are difficult to be stored or described using the chosen programming language. This requires a separate compiler or resource builder, allowing insertion of dialog boxes, icons, menus, images, and other types of resources, including arbitrary binary data. A number of API calls can then be used to retrieve resources from the module. The base of resource data is pointed to by the IMAGE_DIRECTORY_ENTRY_RESOURCE entry of the data directory, and at that location there is an IMAGE_RESOURCE_DIRECTORY structure:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_RESOURCE_DIRECTORY</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">Characteristics</span><span class="p">;</span>
	<span class="kt">long</span> <span class="n">TimeDateStamp</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">MajorVersion</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">MinorVersion</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">NumberOfNamedEntries</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">NumberOfIdEntries</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>Characteristics is unused, and TimeDateStamp is normally the time of creation, although it doesn't matter if it's set or not. MajorVersion and MinorVersion relate to the versioning info of the resources: the fields have no defined values. Immediately following the IMAGE_RESOURCE_DIRECTORY structure is a series of IMAGE_RESOURCE_DIRECTORY_ENTRYs, the number of which are defined by the total of NumberOfNamedEntries and NumberOfIdEntries. The first portion of these entries are for named resources, the latter for ID resources, depending on the values in the IMAGE_RESOURCE_DIRECTORY struct. The actual shape of the resource entry structure is as follows:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_RESOURCE_DIRECTORY_ENTRY</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">NameId</span><span class="p">;</span>
	<span class="kt">long</span> <span class="o">*</span><span class="n">Data</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>The NameId value has dual purpose: if the most significant bit (or sign bit) is clear, then the lower 16 bits are an ID number of the resource. Alternatly, if the top bit is set, then the lower 31 bits make up an offset from the start of the resource data to the name string of this particular resource. The Data value also has a dual purpose: if the most significant bit is set, the remaining 31 bits form an offset from the start of the resource data to another IMAGE_RESOURCE_DIRECTORY (i.e. this entry is an interior node of the resource tree). Otherwise, this is a leaf node, and Data contains the offset from the start of the resource data to a structure which describes the specifics of the resource data itself (which can be considered to be an ordered stream of bytes):</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="k">struct</span> <span class="n">IMAGE_RESOURCE_DATA_ENTRY</span>
<span class="p">{</span>
        <span class="kt">long</span> <span class="o">*</span><span class="n">Data</span><span class="p">;</span>
        <span class="kt">long</span> <span class="n">Size</span><span class="p">;</span>
        <span class="kt">long</span> <span class="n">CodePage</span><span class="p">;</span>
        <span class="kt">long</span> <span class="n">Reserved</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>The Data value contains an RVA to the actual resource data, Size is self-explanatory, and CodePage contains the Unicode codepage to be used for decoding Unicode-encoded strings in the resource (if any). Reserved should be set to 0.</p>
<h3><span class="mw-headline" id="Layout">Layout</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=25" title="Edit section: Layout">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The above system of resource directory and entries allows simple storage of resources, by name or ID number. However, this can get very complicated very quickly. Different types of resources, the resources themselves, and instances of resources in other languages can become muddled in just one directory of resources. For this reason, the resource directory has been given a structure to work by, allowing separation of the different resources.</p>
<p>For this purpose, the "Data" value of resource entries points at another IMAGE_RESOURCE_DIRECTORY structure, forming a tree-diagram like organisation of resources. The first level of resource entries identifies the <i>type</i> of the resource: cursors, bitmaps, icons and similar. They use the ID method of identifying the resource entries, of which there are twelve defined values in total. More user defined resource types can be added. Each of these resource entries points at a resource directory, naming the actual resources themselves. These can be of any name or value. These point at yet another resource directory, which uses ID numbers to distinguish languages, allowing different specific resources for systems using a different language. Finally, the entries in the language directory actually provide the offset to the resource data itself, the format of which is not defined by the PE specification and can be treated as an arbitrary stream of bytes.</p>
<h2><span class="mw-headline" id="Relocations">Relocations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=26" title="Edit section: Relocations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h2><span class="mw-headline" id="Alternate_Bound_Import_Structure">Alternate Bound Import Structure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=27" title="Edit section: Alternate Bound Import Structure">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h2><span class="mw-headline" id="Windows_DLL_Files">Windows DLL Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=28" title="Edit section: Windows DLL Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Windows DLL files are a brand of PE file with a few key differences:</p>
<ul>
<li>A .DLL file extension</li>
<li>A <code>DllMain()</code> entry point, instead of a WinMain() or main().</li>
<li>The DLL flag set in the PE header.</li>
</ul>
<p>DLLs may be loaded in one of two ways, a) at load-time, or b) by calling the LoadModule() Win32 API function.</p>
<h3><span class="mw-headline" id="Function_Exports">Function Exports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=29" title="Edit section: Function Exports">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Functions are exported from a DLL file by using the following syntax:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre> <span class="kr">__declspec</span><span class="p">(</span><span class="n">dllexport</span><span class="p">)</span> <span class="kt">void</span> <span class="n">MyFunction</span><span class="p">()</span> <span class="p">...</span>
</pre></div>
<p>The "__declspec" keyword here is not a C language standard, but is implemented by many compilers to set extendable, compiler-specific options for functions and variables. Microsoft C Compiler and GCC versions that run on windows allow for the __declspec keyword, and the dllexport property.</p>
<p>Functions may also be exported from regular .exe files, and .exe files with exported functions may be called dynamically in a similar manner to .dll files. This is a rare occurrence, however.</p>
<h3><span class="mw-headline" id="Identifying_DLL_Exports">Identifying DLL Exports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=30" title="Edit section: Identifying DLL Exports">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are several ways to determine which functions are exported by a DLL. The method that this book will use (often implicitly) is to use <b>dumpbin</b> in the following manner:</p>
<pre>dumpbin /EXPORTS &lt;dll file&gt;
</pre>
<p>This will post a list of the function exports, along with their ordinal and RVA to the console.</p>
<h3><span class="mw-headline" id="Function_Imports">Function Imports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=31" title="Edit section: Function Imports">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In a similar manner to function exports, a program may import a function from an external DLL file. The dll file will load into the process memory when the program is started, and the function will be used like a local function. DLL imports need to be prototyped in the following manner, for the compiler and linker to recognize that the function is coming from an external library:</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre> <span class="kr">__declspec</span><span class="p">(</span><span class="n">dllimport</span><span class="p">)</span> <span class="kt">void</span> <span class="n">MyFunction</span><span class="p">();</span>
</pre></div>
<h3><span class="mw-headline" id="Identifying_DLL_Imports">Identifying DLL Imports</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit&amp;section=32" title="Edit section: Identifying DLL Imports">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>If is often useful to determine which functions are imported from external libraries when examining a program. To list import files to the console, use <b>dumpbin</b> in the following manner:</p>
<pre>dumpbin /IMPORTS &lt;dll file&gt;
</pre>
<p>You can also use depends.exe to list imported and exported functions. Depends is a a GUI tool and comes with Microsoft Platform SDK.</p>


<!-- Saved in parser cache with key enwikibooks:pcache:idhash:40410-0!*!0!!en!4!* and timestamp 20161008103509 and revision id 3088866
 -->
<noscript>&lt;img src="//en.wikibooks.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /&gt;</noscript></div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;oldid=3088866">https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;oldid=3088866</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://en.wikibooks.org/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="https://en.wikibooks.org/wiki/Category:X86_Disassembly" title="Category:X86 Disassembly">X86 Disassembly</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-anonuserpage">Not logged in</li><li id="pt-anontalk"><a href="https://en.wikibooks.org/wiki/Special:MyTalk" title="Discussion about edits from this IP address [alt-shift-n]" accesskey="n">Discussion for this IP address</a></li><li id="pt-anoncontribs"><a href="https://en.wikibooks.org/wiki/Special:MyContributions" title="A list of edits made from this IP address [alt-shift-y]" accesskey="y">Contributions</a></li><li id="pt-createaccount"><a href="https://en.wikibooks.org/w/index.php?title=Special:CreateAccount&amp;returnto=X86+Disassembly%2FWindows+Executable+Files" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="https://en.wikibooks.org/w/index.php?title=Special:UserLogin&amp;returnto=X86+Disassembly%2FWindows+Executable+Files" title="You are encouraged to log in; however, it is not mandatory [alt-shift-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li id="ca-nstab-main" class="selected"><span><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files" title="View the content page [alt-shift-c]" accesskey="c">Book</a></span></li>
															<li id="ca-talk"><span><a href="https://en.wikibooks.org/wiki/Talk:X86_Disassembly/Windows_Executable_Files" title="Discussion about the content page [alt-shift-t]" accesskey="t" rel="discussion">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label" tabindex="0">
							<span>Variants</span><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#" tabindex="-1"></a>
						</h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="collapsible"><span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;stable=1">Read</a></span></li>
															<li id="ca-current" class="collapsible collapsible selected"><span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;stable=0&amp;redirect=no" title="View this page with the pending changes [alt-shift-v]" accesskey="v">Latest draft</a></span></li>
															<li id="ca-edit"><span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=edit" title="Edit this page [alt-shift-e]" accesskey="e">Edit</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=history" title="Past revisions of this page [alt-shift-h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label" tabindex="0"><span>More</span><a href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="https://en.wikibooks.org/w/index.php" id="searchform">
							<div id="simpleSearch">
							<input type="search" name="search" placeholder="Search" title="Search Wikibooks [alt-shift-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton">							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="https://en.wikibooks.org/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-Navigation" aria-labelledby="p-Navigation-label">
			<h3 id="p-Navigation-label">Navigation</h3>

			<div class="body">
									<ul>
						<li id="n-mainpage"><a href="https://en.wikibooks.org/wiki/Main_Page" title="Visit the main page [alt-shift-z]" accesskey="z">Main Page</a></li><li id="n-help"><a href="https://en.wikibooks.org/wiki/Help:Contents" title="Find help on how to use and edit Wikibooks">Help</a></li><li id="n-Browse"><a href="https://en.wikibooks.org/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer">Browse wiki</a></li><li id="n-Cookbook"><a href="https://en.wikibooks.org/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world">Cookbook</a></li><li id="n-Wikijunior"><a href="https://en.wikibooks.org/wiki/Wikijunior" title="Books for children">Wikijunior</a></li><li id="n-Featured-books"><a href="https://en.wikibooks.org/wiki/Wikibooks:Featured_books" title="The best of Wikibooks">Featured books</a></li><li id="n-recentchanges"><a href="https://en.wikibooks.org/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [alt-shift-r]" accesskey="r">Recent changes</a></li><li id="n-sitesupport"><a href="https://donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikibooks.org&amp;uselang=en" title="Support Wikibooks">Donations</a></li><li id="n-randomrootpage"><a href="https://en.wikibooks.org/wiki/Special:RandomRootpage">Random book</a></li><li id="n-Using-Wikibooks"><a href="https://en.wikibooks.org/wiki/Using_Wikibooks">Using Wikibooks</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-Community" aria-labelledby="p-Community-label">
			<h3 id="p-Community-label">Community</h3>

			<div class="body">
									<ul>
						<li id="n-Reading-room"><a href="https://en.wikibooks.org/wiki/Wikibooks:Reading_room" title="Discuss Wikibooks-related questions and concerns with others">Reading room</a></li><li id="n-portal"><a href="https://en.wikibooks.org/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community">Community portal</a></li><li id="n-currentevents"><a href="https://en.wikibooks.org/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news">Bulletin Board</a></li><li id="n-maintenance"><a href="https://en.wikibooks.org/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with">Help out!</a></li><li id="n-Policies-and-guidelines"><a href="https://en.wikibooks.org/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures">Policies and guidelines</a></li><li id="n-contact"><a href="https://en.wikibooks.org/wiki/Wikibooks:Contact_us" title="Alternative methods of communication">Contact us</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>

			<div class="body">
									<ul>
						<li id="t-whatlinkshere"><a href="https://en.wikibooks.org/wiki/Special:WhatLinksHere/X86_Disassembly/Windows_Executable_Files" title="A list of all wiki pages that link here [alt-shift-j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://en.wikibooks.org/wiki/Special:RecentChangesLinked/X86_Disassembly/Windows_Executable_Files" rel="nofollow" title="Recent changes in pages linked from this page [alt-shift-k]" accesskey="k">Related changes</a></li><li id="t-upload"><a href="https://commons.wikimedia.org/wiki/Special:UploadWizard?uselang=en" title="Upload files [alt-shift-u]" accesskey="u">Upload file</a></li><li id="t-specialpages"><a href="https://en.wikibooks.org/wiki/Special:SpecialPages" title="A list of all special pages [alt-shift-q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;oldid=3088866" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;action=info" title="More information about this page">Page information</a></li><li id="t-cite"><a href="https://en.wikibooks.org/w/index.php?title=Special:CiteThisPage&amp;page=X86_Disassembly%2FWindows_Executable_Files&amp;id=3088866" title="Information on how to cite this page">Cite this page</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-lang" aria-labelledby="p-lang-label"><span class="uls-settings-trigger" title="Language settings" tabindex="0" role="button" aria-haspopup="true"></span>
			<h3 id="p-lang-label">Languages</h3>

			<div class="body">
									<ul>
											</ul>
				<div class="after-portlet after-portlet-lang"><span class="wb-langlinks-add wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:NewItem?site=enwikibooks&amp;page=X86+Disassembly%2FWindows+Executable+Files" title="Add interlanguage links" class="wbc-editpage">Add links</a></span></div>			</div>
		</div>
			<div class="portal" role="navigation" id="p-Sister_projects" aria-labelledby="p-Sister_projects-label">
			<h3 id="p-Sister_projects-label">Sister projects</h3>

			<div class="body">
									<ul>
						<li id="n-Wikipedia"><a href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a></li><li id="n-Wikiversity"><a href="https://en.wikiversity.org/wiki/Wikiversity:Main_Page">Wikiversity</a></li><li id="n-Wiktionary"><a href="https://en.wiktionary.org/wiki/Wiktionary:Main_Page">Wiktionary</a></li><li id="n-Wikiquote"><a href="https://en.wikiquote.org/wiki/Main_Page">Wikiquote</a></li><li id="n-Wikisource"><a href="https://en.wikisource.org/wiki/Main_Page">Wikisource</a></li><li id="n-Wikinews"><a href="https://en.wikinews.org/wiki/Main_Page">Wikinews</a></li><li id="n-Wikivoyage"><a href="https://en.wikivoyage.org/wiki/Main_Page">Wikivoyage</a></li><li id="n-Commons"><a href="https://commons.wikimedia.org/wiki/Main_Page">Commons</a></li><li id="n-Wikidata"><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page">Wikidata</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-coll-print_export" aria-labelledby="p-coll-print_export-label">
			<h3 id="p-coll-print_export-label">Print/export</h3>

			<div class="body">
									<ul>
						<li id="coll-create_a_book"><a href="https://en.wikibooks.org/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=X86+Disassembly%2FWindows+Executable+Files">Create a collection</a></li><li id="coll-download-as-rdf2latex"><a href="https://en.wikibooks.org/w/index.php?title=Special:Book&amp;bookcmd=render_article&amp;arttitle=X86+Disassembly%2FWindows+Executable+Files&amp;returnto=X86+Disassembly%2FWindows+Executable+Files&amp;oldid=3088866&amp;writer=rdf2latex">Download as PDF</a></li><li id="t-print"><a href="https://en.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;printable=yes" title="Printable version of this page [alt-shift-p]" accesskey="p">Printable version</a></li>					</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 9 June 2016, at 13:35.</li>
											<li id="footer-info-copyright">Text is available under the <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License.</a>; additional terms may apply.  By using this site, you agree to the <a href="https://wikimediafoundation.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="https://wikimediafoundation.org/wiki/Privacy_policy">Privacy Policy.</a></li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://wikimediafoundation.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://en.wikibooks.org/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li>
											<li id="footer-places-disclaimer"><a href="https://en.wikibooks.org/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li>
											<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
											<li id="footer-places-cookiestatement"><a href="https://wikimediafoundation.org/wiki/Cookie_statement">Cookie statement</a></li>
											<li id="footer-places-mobileview"><a href="https://en.m.wikibooks.org/w/index.php?title=X86_Disassembly/Windows_Executable_Files&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
							<a href="https://wikimediafoundation.org/"><img src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/wikimedia-button.png" srcset="/static/images/wikimedia-button-1.5x.png 1.5x, /static/images/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation"></a>						</li>
											<li id="footer-poweredbyico">
							<a href="https://www.mediawiki.org/"><img src="./x86 Disassembly_Windows Executable Files - Wikibooks, open books for an open world_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/poweredby_mediawiki_132x47.png 1.5x, /static/images/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>						</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.gadget.extlinks","ext.gadget.commons-file","mmv.bootstrap.autostart","ext.visualEditor.targetLoader","ext.eventLogging.subscriber","ext.wikimediaEvents","ext.navigationTiming","ext.uls.eventlogger","ext.uls.init","ext.uls.compactlinks","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.flaggedRevs.advanced"]);});</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set( {
    "wgPageParseReport": {
        "limitreport": {
            "cputime": "0.080",
            "walltime": "0.414",
            "ppvisitednodes": {
                "value": 360,
                "limit": 1000000
            },
            "ppgeneratednodes": {
                "value": 0,
                "limit": 1500000
            },
            "postexpandincludesize": {
                "value": 2839,
                "limit": 2097152
            },
            "templateargumentsize": {
                "value": 925,
                "limit": 2097152
            },
            "expansiondepth": {
                "value": 10,
                "limit": 40
            },
            "expensivefunctioncount": {
                "value": 0,
                "limit": 500
            },
            "entityaccesscount": {
                "value": 0,
                "limit": 400
            },
            "timingprofile": [
                "100.00%   23.231      1 -total",
                " 52.11%   12.106      1 Template:X86_Disassembly/Page",
                " 47.54%   11.045      1 Template:Info",
                " 43.42%   10.088      1 Template:Mbox",
                " 28.54%    6.631      1 Template:BookCat",
                " 22.23%    5.164      1 Template:Ambox",
                " 15.39%    3.575      1 Template:Ambox/core",
                " 14.55%    3.381      1 Template:Namespace_detect",
                "  6.14%    1.427      1 Template:Lowercase_title",
                "  5.20%    1.209      1 Template:FULLBOOKNAME"
            ]
        },
        "cachereport": {
            "origin": "mw1170",
            "timestamp": "20161008103509",
            "ttl": 2592000,
            "transientcontent": false
        }
    }
} );});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":75,"wgHostname":"mw1268"});});</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>